---
title: "R Notebook"
output: html_notebook
---

# Задача 1
Для маркетингового исследования случайным образом необходимо отобрать N людей. Этим людям далее демонстрируется кофе марки Nescafe в упаковке с новым дизайном: вместо классической этикетки в коричнево-золотых тонах – новогодняя этикетка в красно-зеленых тонах. После этого фиксируется,сколько людей захотели купить этот кофе, а точнее, доля таких людей.Рассчитайте необходимый объем выборки для тестовой группы, если известно, что
•выбран 95%-ный уровень доверия;
•погрешность не должна превышать 3%;
•нет определенных ожиданий относительно доли людей, которые захотят кофе с измененнымдизайном этикетки (считается, что человек с равной вероятностью выберет кофе или не выберет)
N = z**2*p*(1-p)/(error**2)

```{r}
library(DescTools)
N = 1.96 ** 2 * 0.5 * 0.5 / (0.03 ** 2)
N
```
# Задача 2
Решите задачу 1, учитывая, что теперь ожидаемая доля людей, которые захотят купить кофе с измененным дизайном этикетки, известна и равна 0.67 (группа аналитиков нашла старый отчет срезультатами аналогичного эксперимента). Какой из необходимых объемов выборки больше: в случае, когда мы считаем, что шансы выбрать и невыбрать кофе одинаковы или в случае, когда ожидаемая доля выбравших кофе нам известна и равна 0.67? Сделайте вывод о связи между ожидаемой долей и необходимым объемом выборки при прочихравных условиях (тот же уровень доверия).
```{r}
N2 = 1.96 ** 2 * 0.67 * 0.33 / (0.03 ** 2)
N2
```
Во втором случае больше
```{r}
# Обьъем выборки прямо зависит от перемножения p и q, чем меньше произведение, тем меньше объем выборки
p = seq(0,1, length.out = 100)
q = seq(1,0, length.out = 100)
plot(p,p*q)
```
Из графика видно, что наибольший объем выборки нужен при p = q, не помню как это доказывается
# Задача 3
В файле experiment.csv сохранены результаты эксперимента, описанного в задаче 1. Данные представляют собой последовательности из 0 и 1, где 1 соответствуют людям, которые захотели выбрать кофе с измененным дизайном этикетки, а 0 - людям, которые не захотели.Описание данных:
test: результаты по тестовой группе (людям предлагали кофе с новым дизайном этикетки);
control:контрольная группа (людям предлагали кофе со старым дизайном этикетки).
1. Загрузите в R данные из файла experiment.csv с помощью функции read.csv().
2.Постройте в R 90%-ный доверительный интервал для доли людей, которые захотели купить кофе,в тестовой группе.
Проинтерпретируйте полученный доверительный интервал.В решении приведите используемый код, границы доверительного интервала и текст с интерпретацией.
3.Постройте в R 90%-ный доверительный интервал для доли людей, которые захотели купить кофе,в контрольной группе. Проинтерпретируйте полученный доверительный интервал.В решении приведите используемый код, границы доверительного интервала и текст с интерпретацией.
4.Сравните полученные доверительные интервалы для тестовой и контрольной группы. Можно ли на основании полученных результатов сделать определенный вывод о том, что новый дизайн этикетки лучше (привлекает больше потенциальных покупателей)? Приведите ваши выводы иобъяснения.
5.Выполните пункты 1-3 в Python. Изменились ли ваши выводы относительно полезности новогодизайна этикетки? Приведите код, результаты и текст с выводами.
```{r}
# 1
df <- read.csv("./experiment.csv")
df

```
```{r}
# 3,2
control.suc <- sum(df$control)
control.interval <- BinomCI(control.suc, length(df$control), conf.level=0.9)
cat("Доверительный интервал для контрольной группы: ", control.interval[2:3], "\n")
test.suc <- sum(df$test)
test.interval <- BinomCI(test.suc, length(df$test), conf.level=0.9)
cat("Доверительный интервал для тестовой группы: ", test.interval[2:3])
```
# 4
Могу сказать, что люди более склонны брать кофе в новой упаковке
```{python}
# 5
import pandas as pd
import numpy as np
import scipy.stats as st
df = pd.read_csv("./experiment.csv", sep = ",")
n_control = len(df["control"])
p_control = len(df["control"][df["control"] != 0]) / n_control
er_control = np.sqrt(sum(map(lambda x: (x - np.mean(df["control"])) ** 2, df["control"])) / (n_control))
se_control = er_control / np.sqrt(n_control)
interval_control = st.norm.interval(0.90, loc=p_control, scale=se_control)
print("Доверительный интервал для контрольной группы: ", interval_control)
n_test = len(df["test"])
p_test = len(df["test"][df["test"] != 0]) / test
er_test = np.sqrt(sum(map(lambda x: (x - np.mean(df["test"])) ** 2, df["test"])) / (test))
se_test = er_test / np.sqrt(n_test)
interval_test = st.norm.interval(0.90, loc=p_test, scale=se_test)
print("Доверительный интервал для тестовой группы: ", interval_test)
print("Могу сказать, что люди более склонны брать кофе в новой упаковке")
```


